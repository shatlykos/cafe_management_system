{% extends "base.html" %}
{% block title %}–†–∞—Å—Ö–æ–¥—ã ‚Äî GALAXY FOOD{% endblock %}
{% block content %}

<div class="flex-between">
  <h1>üí∏ –†–∞—Å—Ö–æ–¥—ã</h1>
  <button class="btn btn-gold" onclick="openModal('modal-add-expense')">+ –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—Ö–æ–¥</button>
</div>

<!-- –§–∏–ª—å—Ç—Ä -->
<form method="GET" class="form-box" style="padding:16px 20px; margin-top:16px;">
  <div class="form-row" style="margin-bottom:0; align-items:flex-end;">
    <div class="form-group">
      <label>–° –¥–∞—Ç—ã</label>
      <input type="date" name="start" value="{{ start }}">
    </div>
    <div class="form-group">
      <label>–ü–æ –¥–∞—Ç—É</label>
      <input type="date" name="end" value="{{ end }}">
    </div>
    <div>
      <button class="btn btn-brown" type="submit">–ü–æ–∫–∞–∑–∞—Ç—å</button>
    </div>
  </div>
</form>

{% if by_cat %}
<div class="cards" style="margin-top:8px;">
  {% for cat, amt in by_cat.items() %}
  <div class="card" style="min-width:140px; flex:0 1 auto;">
    <div class="card-label">{{ cat }}</div>
    <div class="card-value" style="font-size:22px;">{{ "%.0f"|format(amt) }} GEL</div>
  </div>
  {% endfor %}
  <div class="card" style="min-width:140px; flex:0 1 auto; border:2px solid var(--gold);">
    <div class="card-label">–ò—Ç–æ–≥–æ</div>
    <div class="card-value" style="font-size:22px; color:var(--gold-dark);">{{ "%.0f"|format(total) }} GEL</div>
  </div>
</div>
{% endif %}

{% if expenses %}
<div class="table-wrap">
  <table>
    <thead>
      <tr>
        <th>–î–∞—Ç–∞</th>
        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
        <th class="text-right">–°—É–º–º–∞</th>
      </tr>
    </thead>
    <tbody>
      {% for e in expenses %}
      <tr>
        <td>{{ e.date }}</td>
        <td><span class="badge badge-paid">{{ e.category }}</span></td>
        <td style="color:#888;">{{ e.description or '‚Äî' }}</td>
        <td class="text-right text-gold">{{ "%.0f"|format(e.amount) }} GEL</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<div class="form-box" style="text-align:center; padding:40px; margin-top:8px;">
  <p style="color:#888; font-size:16px;">–†–∞—Å—Ö–æ–¥–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –Ω–µ—Ç.</p>
</div>
{% endif %}

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
<div class="modal-bg" id="modal-add-expense">
  <div class="modal">
    <span class="modal-close" onclick="closeModal('modal-add-expense')">‚úï</span>
    <h2>–ù–æ–≤—ã–π —Ä–∞—Å—Ö–æ–¥</h2>
    <form method="POST" action="{{ url_for('add_expense') }}">
      <div class="form-row">
        <div class="form-group">
          <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
          <select name="category" required>
            <option value="">‚Äî –≤—ã–±–µ—Ä–∏—Ç–µ ‚Äî</option>
            <option>–ê—Ä–µ–Ω–¥–∞</option>
            <option>–ó–∞—Ä–ø–ª–∞—Ç–∞</option>
            <option>–ö–æ–º–º—É–Ω–∞–ª—å–Ω—ã–µ</option>
            <option>–ü—Ä–æ–¥—É–∫—Ç—ã</option>
            <option>–ü—Ä–æ—á–µ–µ</option>
          </select>
        </div>
        <div class="form-group">
          <label>–°—É–º–º–∞ *</label>
          <input type="number" name="amount" placeholder="0" min="0" step="0.01" required>
        </div>
      </div>
      <div class="form-group" style="margin-bottom:14px; margin-top:14px;">
        <label>–î–∞—Ç–∞</label>
        <input type="date" name="date" value="{{ end }}">
      </div>
      <div class="form-group" style="margin-bottom:20px;">
        <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
        <input type="text" name="description" placeholder="–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ">
      </div>
      <button class="btn btn-gold btn-block" type="submit">–ó–∞–ø–∏—Å–∞—Ç—å —Ä–∞—Å—Ö–æ–¥</button>
    </form>
  </div>
</div>

{% endblock %}
