{% extends "base.html" %}
{% block title %}–ë–ª—é–¥–∞ ‚Äî GALAXY FOOD{% endblock %}
{% block content %}

<div class="flex-between">
  <h1>üçΩ –ë–ª—é–¥–∞</h1>
  <button class="btn btn-gold" onclick="openModal('modal-add-dish')">+ –î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ</button>
</div>

{% if dish_data %}
<div class="table-wrap" style="margin-top:20px;">
  <table>
    <thead>
      <tr>
        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
        <th class="text-right">–¶–µ–Ω–∞</th>
        <th class="text-right">–°–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å</th>
        <th class="text-right">–ú–∞—Ä–∂–∞ %</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for item in dish_data %}
      {% set d = item.dish %}
      {% set m = item.margin %}
      <tr>
        <td><strong>{{ d.name }}</strong>{% if d.description %}<br><span style="font-size:12px;color:#aaa;">{{ d.description }}</span>{% endif %}</td>
        <td><span class="badge badge-paid">{{ d.category }}</span></td>
        <td class="text-right text-gold">{{ "%.0f"|format(m.price) }} GEL</td>
        <td class="text-right">{{ "%.0f"|format(m.cost) }} GEL</td>
        <td class="text-right">
          {% if m.margin_percent >= 50 %}
            <span style="color:#2E7D32; font-weight:700;">{{ "%.0f"|format(m.margin_percent) }}%</span>
          {% elif m.margin_percent >= 25 %}
            <span style="color:#E65100; font-weight:700;">{{ "%.0f"|format(m.margin_percent) }}%</span>
          {% else %}
            <span style="color:#B71C1C; font-weight:700;">{{ "%.0f"|format(m.margin_percent) }}%</span>
          {% endif %}
        </td>
        <td>
          <form method="POST" action="{{ url_for('delete_dish', dish_id=d.id) }}"
                onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å ¬´{{ d.name }}¬ª?')">
            <button class="btn btn-red btn-sm" type="submit">‚úï</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<div class="form-box" style="text-align:center; padding:40px; margin-top:20px;">
  <div style="font-size:48px;">üçΩ</div>
  <p style="color:#888; font-size:16px; margin-top:12px;">–ë–ª—é–¥ –ø–æ–∫–∞ –Ω–µ—Ç.</p>
  <button class="btn btn-gold mt-16" onclick="openModal('modal-add-dish')">+ –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤–æ–µ –±–ª—é–¥–æ</button>
</div>
{% endif %}

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: –¥–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ -->
<div class="modal-bg" id="modal-add-dish">
  <div class="modal">
    <span class="modal-close" onclick="closeModal('modal-add-dish')">‚úï</span>
    <h2>–ù–æ–≤–æ–µ –±–ª—é–¥–æ</h2>
    <form method="POST" action="{{ url_for('add_dish') }}">
      <div class="form-group" style="margin-bottom:14px;">
        <label>–ù–∞–∑–≤–∞–Ω–∏–µ *</label>
        <input type="text" name="name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–∞–Ω—Ç—ã" required autofocus>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ *</label>
          <input type="number" name="price" placeholder="0" min="0" step="0.01" required>
        </div>
        <div class="form-group">
          <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
          <select name="category" required>
            <option value="">‚Äî –≤—ã–±–µ—Ä–∏—Ç–µ ‚Äî</option>
            <option>–ó–∞–≤—Ç—Ä–∞–∫–∏</option>
            <option>–û—Å–Ω–æ–≤–Ω—ã–µ –±–ª—é–¥–∞</option>
            <option>–°—É–ø—ã</option>
            <option>–°–∞–ª–∞—Ç—ã</option>
            <option>–î–µ—Å–µ—Ä—Ç—ã</option>
            <option>–ù–∞–ø–∏—Ç–∫–∏</option>
            <option>–ü—Ä–æ—á–µ–µ</option>
          </select>
        </div>
      </div>
      <div class="form-group" style="margin-bottom:20px; margin-top:14px;">
        <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
        <input type="text" name="description" placeholder="–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ">
      </div>
      <button class="btn btn-gold btn-block" type="submit">–î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ</button>
    </form>
  </div>
</div>

{% endblock %}
